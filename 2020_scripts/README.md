# ISMIR proceedings generator

## 2020 edition

The scripts in this folder assume that the metadata for each paper is stored in a .csv file containing headers of:

- `Set` (the session number of each paper)
- `Paper Submission ID` (the ID from Microsoft CMT)
- `Authors` (the author list exactly as exported from Microsoft CMT)
- `Abstract`
- `Title`
- `Q1 (Main message)` (The one-sentence 'main takeaway')

The ordering (or presence of other headers) does not matter. This table can be exported from CMT or assembled manually, if necessary.

Authors are assumed to be listed in the following format:
`Primaryauthor Lastname (Some University)*; SecondaryAuthor Othername (Another University); ... [etc]` where the asterisk always immediately follows the submitting author of the paper. Papers should be in a single folder, all named `[id].pdf` corresponding to their paper submission ID in the csv file.

Note that these scripts were originally written in 2019 to run directly on the exported metadata and papers as downloaded from Microsoft CMT instead of the cleaned versions used this year.  If this is necessary, use the version of `1_merge_csv_papers.py` in the 2019 branch of this repository. This will require you to generate your own session JSON manually as input to step 2 (see below). Additionally, you may need to edit the script for changes that were made in the field names between 2019 and the present.

I've run this process successfully on a windows machine, but you will need to use the Windows Linux Subsystem to run the batch script in step 3.

### Setup

Install python dependencies

    pip install -r requirements.txt

### Generating proceedings

1. Convert CSV to JSON and rename paper files

The papers will be renamed and copied to a new location so that they can be easily referenced in the tex file.

    python 1_merge_csv_papers.py -o ../2020-paper-metadata.json -d ../2020_Proceedings_ISMIR/articles -s ../session_order.json ../papers_2020.csv ../2020_camera_ready_submissions

The `-o` option is the location of the metadata JSON file to write. The `-d` option is
the location of the articles in the directory containing the proceedings tex. The `-s` option is the location of the session JSON file to write.

This operation also performs some basic name normalization if needed, and
extracts the number of pages in each paper.

2. Generate the tex file with the list of papers

You will need a _session order_ file. This is json in the following format:

```
[
    {"name": "Session name",
     "papers": [1, 2, 3]
    }, ...
]
```
Where the ids in the `"papers"` key are the submission ids of papers in CMT. The session name will be used as the section names in the table of contents. This should have been generated by step 1.

    python 2_generate_paper_tex.py -o ../2020_Proceedings_ISMIR/papers.tex ../2020-paper-metadata.json ../session_order.json

3. Build the proceedings

Update the front matter and section headings as needed. These are all saved as
PDF files in the `external` directory, and included in the proceedings with the \includepdf command in the `tutorials.tex`, `keynotes.tex`, and `2020_Proceedings_ISMIR.tex` files. Add or remove files as needed. (Since these sections can change considerably from year-to-year, there's probably no benefit to automating this step.)

When configured, run the `00-run.sh` bash script. It will compile the `2020_Proceedings_ISMIR.tex` file, generate the author index, perform some text normalization, and recompile everything twice more.

    cd 2020_Proceedings_ISMIR
    bash 00-run.sh

4. Split proceedings

This takes the final document and re-generates the PDFs for each paper so that
they have the header (conference name) and footer (page numbers) on them.

Open the PDF of the final proceedings and find the physical page number in the
file where the header page for the first session starts - this is for option `-s`.
`-o` is the directory to write the split articles to.

    python 3_split_proceedings.py -s 39 -o ../2020_Proceedings_ISMIR/split_articles ../2020_Proceedings_ISMIR.pdf ../2020-paper-metadata.json ../session_order.json

5. Generate files for archiving

    This will generate files containing metadata (abstracts, page numbers, authors, etc) used for archiving the final proceedings on Zenodo (see https://github.com/ismir/conference-archive/). Note that the `-s` option here refers to the page number not of the .pdf file but *in the page footer* (i.e. how it would be cited in a bibliography).

    python 4_generate_overview_website.py -o ./website_split -s 13 ../2020-paper-metadata.json ../session_order.json
